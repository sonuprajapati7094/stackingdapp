<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üõ†Ô∏è USDT Staking ‚Äî Admin Panel</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
  <style>
    body { background:#111; color:#fff; font-family:Arial, sans-serif; text-align:center; }
    .card { background:#1c1c1c; padding:20px; margin:20px auto; border-radius:10px; max-width:600px; }
    button { margin:5px; padding:10px 20px; border:none; border-radius:6px; cursor:pointer; }
    button:hover { opacity:0.9; }
    .primary { background:#f0b90b; color:#000; }
    .secondary { background:#333; color:#fff; }
    .danger { background:#d9534f; color:#fff; }
    .info { background:#0275d8; color:#fff; }
  </style>
</head>
<body>
  <h2>üõ†Ô∏è USDT Staking ‚Äî Admin Panel</h2>
  <button id="connectBtn" class="primary">üîó Connect Admin Wallet</button>
  <p id="wallet">Wallet: not connected</p>
  <p id="status" style="color:red;">Connection failed</p>

  <div class="card">
    <h3>Mint MockUSDT</h3>
    <input type="text" id="mintTo" placeholder="Recipient Address" />
    <input type="number" id="mintAmount" placeholder="Amount (USDT)" />
    <button onclick="mintTokens()" class="primary">Mint</button>
  </div>

  <div class="card">
    <h3>Set Staking Params</h3>
    <p>ROI (basis points), Lock (sec), MinTx (6 decimals), CapX</p>
    <input type="number" id="roi" placeholder="ROI BP (e.g. 1800)" />
    <input type="number" id="lock" placeholder="Lock Seconds (e.g. 7776000)" />
    <input type="number" id="minTx" placeholder="MinTx (e.g. 1000000)" />
    <input type="number" id="capx" placeholder="CapX (e.g. 3)" />
    <button onclick="setParams()" class="info">Update Params</button>
  </div>

  <div class="card">
    <h3>üìä System Overview</h3>
    <p id="totalStaked">Total Staked: -</p>
    <p id="totalRewards">Total Rewards Distributed: -</p>
    <p id="roiBP">Current ROI: -</p>
    <button onclick="getOverview()" class="secondary">Refresh Overview</button>
  </div>

<script>
const STAKING_ADDRESS = "0x8B336d8c0e8905aAd3583D93D187A9072e647662";
const TOKEN_ADDRESS   = "0xEbA5032Be8fc2d2a2fa29e134853ab6aAA12fa1C";

// ‚úÖ MockUSDT ABI
const tokenAbi = [
  {"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[],"stateMutability":"nonpayable","type":"function"},
  {"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},
  {"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}
];

// ‚úÖ Staking Contract ABI
const stakingAbi = [
  {"inputs":[{"internalType":"uint256","name":"_roiBP","type":"uint256"},{"internalType":"uint256","name":"_lockSeconds","type":"uint256"},{"internalType":"uint256","name":"_minTx","type":"uint256"},{"internalType":"uint256","name":"_capX","type":"uint256"}],"name":"setParams","outputs":[],"stateMutability":"nonpayable","type":"function"},
  {"inputs":[],"name":"totalStaked","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[],"name":"totalRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[],"name":"roiBP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}
];

let provider, signer, token, staking, admin;

async function connectWallet() {
  try {
    await window.ethereum.request({ method: "eth_requestAccounts" });
    provider = new ethers.providers.Web3Provider(window.ethereum);
    signer = provider.getSigner();
    admin = await signer.getAddress();
    token = new ethers.Contract(TOKEN_ADDRESS, tokenAbi, signer);
    staking = new ethers.Contract(STAKING_ADDRESS, stakingAbi, signer);
    document.getElementById("wallet").innerText = "Wallet: " + admin;
    document.getElementById("status").innerText = "‚úÖ Connected (Admin)";
  } catch (err) {
    document.getElementById("status").innerText = "‚ùå Connection failed";
  }
}

async function mintTokens() {
  const to = document.getElementById("mintTo").value;
  const amount = document.getElementById("mintAmount").value;
  await token.mint(to, ethers.utils.parseUnits(amount, 6));
}

async function setParams() {
  const roi = document.getElementById("roi").value;
  const lock = document.getElementById("lock").value;
  const minTx = document.getElementById("minTx").value;
  const capx = document.getElementById("capx").value;
  await staking.setParams(roi, lock, minTx, capx);
}

async function getOverview() {
  const staked = await staking.totalStaked();
  const rewards = await staking.totalRewards();
  const roi = await staking.roiBP();
  document.getElementById("totalStaked").innerText = "Total Staked: " + ethers.utils.formatUnits(staked, 6) + " USDT";
  document.getElementById("totalRewards").innerText = "Total Rewards Distributed: " + ethers.utils.formatUnits(rewards, 6) + " USDT";
  document.getElementById("roiBP").innerText = "Current ROI: " + roi + " BP";
}

document.getElementById("connectBtn").addEventListener("click", connectWallet);
</script>
</body>
</html>
